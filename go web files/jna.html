<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Post Announcement</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <style>
        :root { --bg:#f7f7fb; --card:#fff; --border:#e5e7eb; --text:#111827; --muted:#6b7280; --accent:#27ae60; }
        * { box-sizing: border-box; }
        body { margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial; background:var(--bg); color:var(--text); }
        .wrap { max-width:720px; margin:40px auto; padding:0 16px; }
        .card { background:var(--card); border:1px solid var(--border); border-radius:12px; padding:18px; box-shadow:0 2px 10px rgba(0,0,0,.04); }
        h1 { margin:0 0 14px; font-size:1.25rem; }
        label { display:block; font-weight:600; margin:12px 0 6px; }
        input[type="text"], input[type="password"], input[type="number"], textarea {
            width:100%; padding:10px 12px; border:1px solid var(--border); border-radius:8px; font:inherit; background:#fff;
        }
        textarea { min-height:140px; resize:vertical; }
        .row { display:flex; gap:12px; }
        .row > div { flex:1; }
        .muted { color:var(--muted); font-size:.9rem; }
        button {
            border:0; padding:10px 14px; border-radius:10px; font-weight:700; cursor:pointer;
            background:var(--accent); color:white; margin-top:14px;
        }
        .out { margin-top:16px; font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace; background:#0b1220; color:#e5e7eb; padding:14px; border-radius:10px; white-space:pre-wrap; }
        .ok { color:#059669; }
        .err { color:#dc2626; }
    </style>
</head>
<body>
<div class="wrap">
    <div class="card">
        <h1>Post Announcement</h1>
        <p class="muted">This sends a <strong>GET</strong> request to <code>https://jgltechnologies.com/jnau</code> with the fields below placed in request <em>headers</em> (<code>Pass</code>, <code>Title</code>, <code>Body</code>, <code>Expire</code> days).</p>

        <form id="annForm">
            <label for="pass">Password (header: Pass)</label>
            <input id="pass" name="pass" type="password" required placeholder="••••••••" />

            <div class="row">
                <div>
                    <label for="title">Title (header: Title)</label>
                    <input id="title" name="title" type="text" required placeholder="Release v1.2.3" />
                </div>
                <div>
                    <label for="expire">Expire (days) (header: Expire)</label>
                    <input id="expire" name="expire" type="number" min="0" step="1" value="7" required />
                </div>
            </div>

            <label for="body">Body (header: Body)</label>
            <textarea id="body" name="body" required placeholder="Short announcement text…"></textarea>

            <button type="submit">Send</button>
            <div id="status" class="muted" style="margin-top:8px;"></div>
        </form>

        <div id="output" class="out" style="display:none;"></div>

        <p class="muted" style="margin-top:10px;">
            Note: Browsers will do a CORS preflight for custom headers. Make sure your
            <code>/jnau</code> handler responds with the right CORS headers (e.g.
            <code>Access-Control-Allow-Origin</code>, <code>Access-Control-Allow-Headers</code> including
            <code>Pass, Title, Body, Expire</code>, and handles <code>OPTIONS</code>).
        </p>
    </div>
</div>

<script>
    const form = document.getElementById('annForm');
    const statusEl = document.getElementById('status');
    const outEl = document.getElementById('output');

    function oneLine(s) {
        // Headers cannot contain CR/LF. Flatten newlines and trim.
        return String(s || '').replace(/[\r\n]+/g, ' ').trim();
    }

    form.addEventListener('submit', async (e) => {
        e.preventDefault();
        statusEl.textContent = 'Sending…';
        outEl.style.display = 'none';
        outEl.textContent = '';

        const pass = document.getElementById('pass').value;
        const title = document.getElementById('title').value;
        const body = oneLine(document.getElementById('body').value);
        const expire = String(parseInt(document.getElementById('expire').value, 10) || 0);

        try {
            const res = await fetch('https://jgltechnologies.com/jnau', {
                method: 'GET',
                mode: 'cors',
                headers: {
                    'Pass': pass,
                    'Title': oneLine(title),
                    'Body': body,
                    'Expire': expire
                },
                // No body — your server reads only headers.
                credentials: 'omit',
                cache: 'no-store'
            });

            const text = await res.text().catch(() => '');
            statusEl.innerHTML = res.ok
                ? `<span class="ok">Success</span> (HTTP ${res.status})`
                : `<span class="err">Failed</span> (HTTP ${res.status})`;
            outEl.style.display = 'block';
            outEl.textContent = text || '(empty response body)';
        } catch (err) {
            statusEl.innerHTML = `<span class="err">Network error</span>`;
            outEl.style.display = 'block';
            outEl.textContent = String(err);
        }
    });
</script>
</body>
</html>
